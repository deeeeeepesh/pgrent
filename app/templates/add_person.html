{% extends "base.html" %}
{% block content %}
<h2>Add Person</h2>
<form method="post" action="/person/add">
  <input name="name" placeholder="Name" required><br>
  <input name="id_proof" placeholder="ID proof (text)"><br>
  <select name="room_id" id="room_select" onchange="loadBeds()" required>
    <option value="">Select room</option>
    {% for r in rooms %}
      <option value="{{r.id}}">{{r.name}}</option>
    {% endfor %}
  </select><br>
  <select name="bed_id" id="bed_select" required>
    <option value="">Select bed</option>
  </select><br>
  <input name="base_rent" placeholder="Base rent" type="number" step="0.01" required><br>
  <button type="submit">Add</button>
</form>

<script>
async function loadBeds(){
  const rid = document.getElementById('room_select').value;
  const sel = document.getElementById('bed_select');
  sel.innerHTML = '<option>Loadingâ€¦</option>';
  const res = await fetch('/static/bed-options.json').catch(()=>null);
  // fallback: reload page to show beds (simple approach)
  location.href = '/room/' + rid;
}
</script>

{% endblock %}
